<!DOCTYPE html>
<html>
<head>
  <title>MQTT Dashboard</title>
  <meta charset="utf-8" />
  <script>
    async function fetchData() {
        try {
            const response = await fetch('/data');
            const messages = await response.json();

            const consoleDiv = document.getElementById("console");
            consoleDiv.innerHTML = ""; // clear previous content

            messages.forEach(msg => {
            const line = `[${msg.timestamp}] ${msg.topic} â†’ ${msg.payload}`;
            const p = document.createElement("div");
            p.textContent = line;
            consoleDiv.appendChild(p);
            });
        } catch (err) {
            console.error("Error fetching data:", err);
        }
    }

    setInterval(fetchData, 100); // Fetch every 2 seconds
    window.onload = fetchData;
  </script>
</head>
<body>
    <h1>ðŸ“¡ MQTT Message Dashboard</h1>
    <p><strong>Timestamp:</strong> <span id="timestamp">-</span></p>
    <p><strong>Topic:</strong> <span id="topic">-</span></p>
    <div id="console" style="font-family: monospace; background: #111; color: #0f0; padding: 1em; height: 150px; overflow-y: auto;">
    Loading...
    </div>
  <!-- <p><strong>Payload:</strong> <span id="payload">-</span></p> -->
</body>
</html>